<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculate actual overlap and corresponding p-value using the hypergeometric distribution as well as the expected overlap."><title>Calculate overlap and p-value — calculate.overlap.and.pvalue • BoutrosLab.statistics.general</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate overlap and p-value — calculate.overlap.and.pvalue"><meta property="og:description" content="Calculate actual overlap and corresponding p-value using the hypergeometric distribution as well as the expected overlap."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BoutrosLab.statistics.general</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate overlap and p-value</h1>
      
      <div class="d-none name"><code>calculate.overlap.and.pvalue.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate actual overlap and corresponding p-value using the hypergeometric distribution as well as the expected overlap.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate.overlap.and.pvalue</span><span class="op">(</span><span class="va">list1</span>, <span class="va">list2</span>, <span class="va">total.size</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span>, adjust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>;</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>list1</dt>
<dd><p>Vector representing a query list</p></dd>

  <dt>list2</dt>
<dd><p>Vector representing a reference list being compared to</p></dd>

  <dt>total.size</dt>
<dd><p>Numerical value representing the total size of reference sample pool</p></dd>

  <dt>lower.tail</dt>
<dd><p>logical for calculating p-value; if TRUE (default), probability is P[X &lt;= x], otherwise, P[X &gt; x] unless adjust = TRUE.  See phyper</p></dd>

  <dt>adjust</dt>
<dd><p>logical for calculations for lower.tail = FALSE; if FALSE (default), P[X &gt; x], otherwise, P[X &gt;= x]</p></dd>

  </dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Calculations are based on using list2 as the basis for comparison but if list1 and list2 come from the same sample pool, it doesn't matter how list1 or list2 are designated. Be careful when interpreting results for lower.tail = FALSE because probability is P[X &gt; x] and not P[X &gt;= x].</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a three-element vector containing the actual overlap, expected overlap and p-value</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Paul C. Boutros and Denise Mak</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/Hypergeometric.html" class="external-link">phyper</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># SNP array example 1</span></span></span>
<span class="r-in"><span><span class="co"># Total number of SNPs on array is 2000</span></span></span>
<span class="r-in"><span><span class="co"># Identified 56 special SNPs in group1</span></span></span>
<span class="r-in"><span><span class="co"># Identified 78 special SNPs in group2</span></span></span>
<span class="r-in"><span><span class="co"># 10 interesting SNPs are common to both groups</span></span></span>
<span class="r-in"><span><span class="co"># Question: Is 10 greater or less than what we would expect?</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">list1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"SNP"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">56</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">list2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"SNP"</span>, <span class="fl">47</span><span class="op">:</span><span class="fl">124</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">total.size</span> <span class="op">&lt;-</span> <span class="fl">2000</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Expected overlap is 2.2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SNP array example 2</span></span></span>
<span class="r-in"><span><span class="co"># Total number of SNPs on array is 2000</span></span></span>
<span class="r-in"><span><span class="co"># 500 SNPs on array found on chromosome 1 </span></span></span>
<span class="r-in"><span><span class="co"># Identified 41 special SNPs</span></span></span>
<span class="r-in"><span><span class="co"># 5 interesting SNPs found on chromosome 1</span></span></span>
<span class="r-in"><span><span class="co"># Question: Is 5 over or under-represented on chromosome 1 as compared to</span></span></span>
<span class="r-in"><span><span class="co"># the proportion of chromosome 1 SNPs on the array?</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">list1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"SNP"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">41</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">list2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"SNP"</span>, <span class="fl">37</span><span class="op">:</span><span class="fl">536</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">total.size</span> <span class="op">&lt;-</span> <span class="fl">2000</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Expected overlap is 10.3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate if over-represented</span></span></span>
<span class="r-in"><span><span class="fu">calculate.overlap.and.pvalue</span><span class="op">(</span></span></span>
<span class="r-in"><span>  list1 <span class="op">=</span> <span class="va">list1</span>, </span></span>
<span class="r-in"><span>  list2 <span class="op">=</span> <span class="va">list2</span>,</span></span>
<span class="r-in"><span>  total.size <span class="op">=</span> <span class="va">total.size</span>,</span></span>
<span class="r-in"><span>  lower.tail <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  adjust <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Calculating P[X &gt;= x]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  5.0000000 10.2500000  0.9874854</span>
<span class="r-in"><span><span class="co"># Note: calculation is for P[X &gt; x]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate if under-represented</span></span></span>
<span class="r-in"><span><span class="fu">calculate.overlap.and.pvalue</span><span class="op">(</span></span></span>
<span class="r-in"><span>  list1 <span class="op">=</span> <span class="va">list1</span>, </span></span>
<span class="r-in"><span>  list2 <span class="op">=</span> <span class="va">list2</span>,</span></span>
<span class="r-in"><span>  total.size <span class="op">=</span> <span class="va">total.size</span>,</span></span>
<span class="r-in"><span>  lower.tail <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  adjust <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  5.00000000 10.25000000  0.03507362</span>
<span class="r-in"><span><span class="co"># Note: calculation is for P[X &lt;= x]</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Paul Boutros.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

